---
services:
  plain:
    lifecycle:
      startup:
        all: "{platform.invoke} {args}"

  sleeperB:
    lifecycle:
      run: |-
        while true; do
        date; echo sleeperB_running; sleep 5
        done

  sleeperA:
    dependencies:
      - sleeperB
    lifecycle:
      run: |-
        while true; do
        date; echo sleeperA_running; sleep 5
        done

  main:
    dependencies:
      - sleeperA
      - sleeperB
    lifecycle:
      run: |-
        while true; do
        date; echo main_running; sleep 5
        done